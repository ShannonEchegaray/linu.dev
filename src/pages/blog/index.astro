---
import Layout from 'layout/Layout.astro'
import { getCollection } from 'astro:content'

const posts = (await getCollection('blog')).sort(
	(a, b) => b.data.publishDate.valueOf() - a.data.publishDate.valueOf()
)

const postIsNEW = (post) => {
    const today = new Date()
    const postDate = new Date(post.data.publishDate)
    const diffTime = Math.abs(today - postDate)
    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24))
    return diffDays <= 14
}
---
<Layout>
  <div class='flex items-start justify-start w-full px-6 md:px-24 mb-16'>
    <div class="text-sm breadcrumbs">
      <ul>
        <li><a href='/' class='underline underline-offset-2 text-primary hover:text-accent transition-all ease-in-out duration-500'>Inicio</a></li> 
        <li class='text-accent'>Blog</li>
      </ul>
    </div>
  </div>
  <h2 class='flex items-center justify-center w-full font-mona-sans [font-stretch:ultra-expanded] text-2xl sm:text-3xl md:text-4xl lg:text-6xl py-8 font-black'>Todos los art√≠culos</h2>
  <div class='divider px-24'></div>
  <section class='flex items-center justify-center'>
     <ul class='flex flex-col items-center justify-center gap-10 font-mona-sans'>
      {
      posts.map((post) => (
      <a href={`/blog/${post.slug}/`} class=''>
        <li class='bg-neutral shadow-xl justify-between outline-none hover:outline-primary hover:outline-1 transition-all ease-in-out duration-700'>
        <div class='card-body min-w-[1000px]'>
          <div class='flex-col items-start justify-start'>
            <h2 class='card-title [font-stretch:ultra-expanded] font-bold text-2xl items-start line-clamp-2'>
              {post.data.title}
            </h2>
            <p class=''>{postIsNEW(post) && <span class='badge badge-md badge-accent absolute top-4 right-4'>NEW</span>}</p>
            <p class='line-clamp-2 text-neutral-content text-opacity-60'>{post.data.description}</p>
          </div>
          <div class='card-actions items-end justify-end'>
            { post.data.tags.map((tag) => (
              <span class='badge badge-outline badge-lg'>{tag}</span>
            ))}
          </div>
        </div>
      </li>
    </a>
  ))
  }
  </ul>
  </section>
</Layout>
